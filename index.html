<!DOCTYPE html>
<html lang="tg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferrari Investment</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --main: #ff4d6d; --bg: #fdf0f3; --card: #ffffff; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: sans-serif; }
        body { background: var(--main); padding-bottom: 70px; }

        /* --- Auth Screen --- */
        #auth-screen { 
            background: white; min-height: 100vh; padding: 40px 20px; 
            display: none; flex-direction: column; align-items: center; 
        }
        .input-box { width: 100%; max-width: 350px; margin-bottom: 15px; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; margin-top: 5px; }

        /* --- App Screens --- */
        .screen { display: none; padding: 15px; background: var(--bg); min-height: 100vh; border-radius: 25px 25px 0 0; }
        .active { display: block; }
        .header { text-align: center; padding: 15px; color: white; font-weight: bold; font-size: 18px; }

        /* --- VIP Cards --- */
        .product-card {
            background: var(--card); border-radius: 20px; padding: 15px; margin-bottom: 15px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); border: 1px solid #ffe5ec;
        }
        .info b { color: #ff4d6d; }
        .product-img { width: 110px; height: 80px; border-radius: 12px; object-fit: cover; }
        .btn-buy { 
            background: var(--main); color: white; border: none; padding: 10px; 
            border-radius: 15px; width: 100%; margin-top: 10px; font-weight: bold; cursor: pointer;
        }

        /* --- Balance Card --- */
        .balance-card {
            background: linear-gradient(135deg, #ff4d6d, #ff758c);
            color: white; padding: 25px; border-radius: 20px; margin-bottom: 20px;
        }

        /* --- Nav --- */
        .nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; padding: 10px 0; border-top: 1px solid #eee; }
        .nav-item { flex: 1; text-align: center; color: #999; font-size: 12px; cursor: pointer; }
        .nav-item.active { color: var(--main); }
        .nav-item i { font-size: 20px; display: block; }
    </style>
</head>
<body>

    <div id="auth-screen">
        <h2 style="color: var(--main); margin-bottom: 20px;">Бақайдгирӣ</h2>
        <div class="input-box">
            <label>Почта ё Телефон</label>
            <input type="text" id="login-input" placeholder="Введите email или номер">
        </div>
        <div class="input-box">
            <label>Парол</label>
            <input type="password" id="pass-input" placeholder="Минимум 6 аломат">
        </div>
        <button class="btn-buy" style="max-width:350px;" onclick="register()">ВАРУД ШУДАН</button>
    </div>

    <div id="main-app" style="display: none;">
        <div class="header" id="header-title">Маҳсулотҳо</div>

        <div id="products-screen" class="screen active">
            <div id="vip-render"></div>
        </div>

        <div id="profile-screen" class="screen">
            <div class="balance-card">
                <p>ID: <span id="display-id"></span></p>
                <h1 id="user-total-profit">TJS 0.00</h1>
                <p style="font-size: 13px; opacity: 0.9;">Даромади умумии солона аз VIP-ҳо</p>
            </div>
            
            <div style="background:white; padding:15px; border-radius:15px;">
                <p><b>VIP-ҳои фаъоли ман:</b></p>
                <div id="my-vips" style="margin-top:10px; font-size: 14px; color: #555;">Шумо ҳоло ягон VIP надоред.</div>
            </div>
            
            <button class="btn-buy" style="margin-top:20px; background:#555;" onclick="logout()">БАРОМАДАН АЗ АККАУНТ</button>
        </div>

        <div class="nav">
            <div class="nav-item active" onclick="tab('products-screen', 'Маҳсулотҳо', this)"><i class="fa fa-car"></i>Маҳсулот</div>
            <div class="nav-item" onclick="tab('profile-screen', 'Ман', this)"><i class="fa fa-user"></i>Ман</div>
        </div>
    </div>

    <script>
        const vips = [
            { id: 1, name: "Ferrari-1", price: 180, daily: 22, yearly: 7920, img: "https://images.unsplash.com/photo-1592198084033-aade902d1aae?w=200" },
            { id: 2, name: "Ferrari-2", price: 450, daily: 59, yearly: 21240, img: "https://images.unsplash.com/photo-1583121274602-3e2820c69888?w=200" },
            { id: 3, name: "Ferrari-3", price: 1000, daily: 140, yearly: 50400, img: "https://images.unsplash.com/photo-1614162692292-7ac56d7f7f1e?w=200" }
        ];

        // Маълумоти корбар дар хотира
        let userData = JSON.parse(localStorage.getItem('ferrari_user')) || null;

        function checkAuth() {
            if (userData) {
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('main-app').style.display = 'block';
                document.getElementById('display-id').innerText = userData.login;
                updateProfile();
                renderVips();
            } else {
                document.getElementById('auth-screen').style.display = 'flex';
                document.getElementById('main-app').style.display = 'none';
            }
        }

        function register() {
            const login = document.getElementById('login-input').value;
            const pass = document.getElementById('pass-input').value;
            if(login.length < 3 || pass.length < 5) return alert("Маълумотро пурра ворид кунед!");

            userData = { login: login, activeVips: [], totalYearly: 0 };
            localStorage.setItem('ferrari_user', JSON.stringify(userData));
            checkAuth();
        }

        function renderVips() {
            const container = document.getElementById('vip-render');
            container.innerHTML = "";
            vips.forEach(v => {
                const isBought = userData.activeVips.includes(v.id);
                container.innerHTML += `
                    <div class="product-card">
                        <div class="info">
                            <h3>${v.name}</h3>
                            <p>Нарх: <b>${v.price} TJS</b></p>
                            <p>Рӯзона: <b>${v.daily} TJS</b></p>
                            <p>Солона: <b>${v.yearly} TJS</b></p>
                            <button class="btn-buy" onclick="buyVip(${v.id})" ${isBought ? 'disabled style="background:#ccc"' : ''}>
                                ${isBought ? 'ФАЪОЛ АСТ' : 'ҲОЛО ХАРИДАН'}
                            </button>
                        </div>
                        <img src="${v.img}" class="product-img">
                    </div>
                `;
            });
        }

        function buyVip(id) {
            const vip = vips.find(v => v.id === id);
            // Дар барномаи воқеӣ инҷо бояд ба Телеграм гузарад барои тасдиқи чек
            // Барои намуна мо фавран илова мекунем:
            userData.activeVips.push(id);
            userData.totalYearly += vip.yearly;
            localStorage.setItem('ferrari_user', JSON.stringify(userData));
            
            alert(`Табрик! ${vip.name} фаъол шуд. Даромади солонаи шумо зиёд шуд.`);
            renderVips();
            updateProfile();
            
            // Фиристодан ба Телеграм барои огоҳии админ
            window.location.href = `https://t.me/ad_min_boy?text=Ман VIP-${id}-ро харидам!`;
        }

        function updateProfile() {
            document.getElementById('user-total-profit').innerText = `TJS ${userData.totalYearly.toLocaleString()}`;
            const list = document.getElementById('my-vips');
            if(userData.activeVips.length > 0) {
                list.innerHTML = userData.activeVips.map(id => {
                    const v = vips.find(x => x.id === id);
                    return `✅ ${v.name} (Солона: ${v.yearly} TJS)<br>`;
                }).join('');
            }
        }

        function tab(id, title, el) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.getElementById('header-title').innerText = title;
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
        }

        function logout() {
            localStorage.removeItem('ferrari_user');
            location.reload();
        }

        window.onload = checkAuth;
    </script>
</body>
</html>
